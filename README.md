# BYR-Archive-By-Liuchenyu
Actually,It's a little bit difficult for me .To be honest,I haven't leart JavaScript before this test,but in 10 days,I've read a book about Javascript,and my blog will be uploaded later.Most of my code is written by Ai ,what I did is to correct it.(我觉得应该可以写中文吧？下文以中文书写）


# CDN服务开发心路历程

## 一、这个项目到底要干啥？

说实话，刚开始看到这个题目的时候，我整个人都是懵的。什么npm、registry、tarball……这些名词对我来说就像天书一样。后来慢慢琢磨才明白，原来就是让我做一个**“代码包快递站”**：

- **npm仓库**就像是个大仓库，里面堆满了各种代码包
- **我的任务**就是开个快递点，别人想要什么包里的什么文件，我帮他们去仓库取过来

说白了，就是做一个简化版的jsDelivr，让大家能直接通过浏览器访问npm包里的文件。

## 二、我是怎么一步步把这个项目搭起来的

### 2.1 先从能跑起来开始

我的第一个想法特别简单：**先让服务能跑起来再说**。就像搭积木，先有个底座。

```javascript
// 最开始的代码就是这么简单
app.listen(3000, () => {
  console.log('服务跑起来啦！');
});
```

### 2.2 遇到的第一个坎儿：缓存该怎么搞？

刚开始我想，每次有人要文件我都去npm仓库取，那不得慢死了？于是想到了加缓存。

但问题来了：缓存太多会占内存，缓存太少又没效果。纠结了好久，最后选择了**LRU缓存**——就像手机内存满了自动删最久没用的App，这样既省内存又能保证常用文件都在。

```javascript
// 这是我的缓存配置，调了好几次才确定这些参数
const cache = new LRUCache({
  max: 1000, // 最多存1000个文件
  ttl: 1000 * 60 * 30, // 30分钟自动过期
  maxSize: 50 * 1024 * 1024, // 不能超过50MB
});
```

### 2.3 版本号解析：没想到这么麻烦！

我原本以为版本号就是像`1.0.0`这样的数字，结果发现还有`^1.2.0`、`latest`、`beta`这种写法。当时真的头大！

后来找到了`semver`这个库，它专门处理版本号，简直就是我的救星。不过调试的时候还是踩了不少坑，比如有些包没有`latest`标签，得做异常处理。

### 2.4 最让我头疼的问题：tarball解压

这是我现在还没完全解决的大难题。npm包下载下来是`.tgz`格式的压缩包，需要解压才能拿到里面的文件。

我本来想用`tar-stream`库，但试了几次都没成功。为了不让项目卡住，我暂时用了模拟数据：

```javascript
// 这里其实应该解压tarball，但我现在还不会
return Buffer.from(`// Content of ${filePath}`); // 先糊弄一下
```

**这个是我接下来最需要攻克的难关！**

## 三、我的代码有哪些亮点和槽点

### 做得还不错的地方：

1. **模块分得比较清楚**：缓存、npm获取、压缩都分开写，以后好改
2. **想到了性能优化**：加了压缩和缓存，速度会快不少
3. **错误处理还算贴心**：服务挂了会给出友好提示，不是一堆看不懂的错误码

### 需要继续改进的地方：

1. **tarball解压还没搞定**：这是核心功能，必须解决
2. **入口文件解析没做**：题目要求自动找到包的入口文件，这个我还没做
3. **目录列表功能缺失**：现在还看不到包里有啥文件
4. **安全方面考虑不够**：没做输入校验，可能会被恶意攻击

## 四、做这个项目让我学到了什么

### 4.1 技术上的成长

- **第一次真正理解CDN是啥**：以前只知道CDN快，现在知道是怎么快的了
- **学会了缓存策略**：不是所有东西都缓存就好，要平衡速度和内存
- **对npm包管理有了新认识**：原来版本号还有这么多讲究

### 4.2 心态上的变化

**从害怕到接受**：刚开始看到复杂需求很慌，后来学会了一点一点拆解问题。就像吃一个大蛋糕，一口一口吃总能吃完。

**学会了“先完成再完美”**：tarball解压虽然没做好，但至少服务能跑起来了。这比什么都做不出来强多了。

## 五、如果时间能重来，我会怎么做

1. **先实现最核心的文件获取功能**，哪怕一开始只能返回假数据
2. **早点找人请教tarball解压的问题**，不应该自己闷头搞
3. **多写测试代码**，现在改一点东西都怕把其他地方搞坏
4. **先把基础功能做扎实**，再考虑那些花里胡哨的优化

## 六、一些说明

使用的工具名称：Copilot

生成内容的范围：大致框架（感谢一下AI提供的代码框架，让我有了起步的方向。虽然很多地方我还不太懂，但通过这个项目，我真正体会到了**“在做中学”**的感觉）

人工修改情况信息：
- 结构调整: 按照技术报告标准格式重新组织内容
- 问题分析: 解决AI写的bug

有时候调一个bug要花好几个小时，但解决的那一刻的成就感，真的是看多少教程都换不来的。这个项目虽然还有很多不足，但它是我学习路上的一个重要里程碑。

**下一步，我一定要把tarball解压搞定！**

---
*写于一个调试到深夜的晚上* 😴
